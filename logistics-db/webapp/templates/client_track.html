{% extends "base.html" %}

{% block title %}Отслеживание груза{% endblock %}

{% block nav_links %}
<li class="nav-item">
    <a class="nav-link" href="{{ url_for('client.dashboard') }}">
        <i class="bi bi-house"></i> Главная
    </a>
</li>
<li class="nav-item">
    <a class="nav-link active" href="{{ url_for('client.track') }}">
        <i class="bi bi-search"></i> Отслеживание
    </a>
</li>
{% endblock %}

{% block content %}
<div class="row mt-4">
    <div class="col-md-8 offset-md-2">
        <h2 class="text-center">
            <i class="bi bi-search"></i> Отслеживание груза
        </h2>
        <p class="text-muted text-center">Введите номер груза для отслеживания</p>

        <!-- Форма поиска -->
        <div class="card mt-4 shadow">
            <div class="card-body p-4">
                <form method="GET" action="{{ url_for('client.track') }}">
                    <div class="input-group input-group-lg">
                        <span class="input-group-text">
                            <i class="bi bi-upc-scan"></i>
                        </span>
                        <input type="text" 
                               name="number" 
                               class="form-control" 
                               placeholder="Введите номер груза (например: CRG-001)" 
                               value="{{ request.args.get('number', '') }}"
                               required 
                               autofocus>
                        <button class="btn btn-primary" type="submit">
                            <i class="bi bi-search"></i> Найти
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Результат поиска -->
        {% if cargo_info %}
        <div class="card mt-4 border-success shadow slide-in-right">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">
                    <i class="bi bi-check-circle"></i> Груз найден!
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <p><strong><i class="bi bi-upc"></i> Номер груза:</strong></p>
                        <h4>{{ cargo_info['номер_груза'] }}</h4>
                    </div>
                    <div class="col-md-6">
                        <p><strong><i class="bi bi-info-circle"></i> Текущий статус:</strong></p>
                        <h4>
                            <span class="badge bg-primary">
                                {{ cargo_info['статус'] }}
                            </span>
                        </h4>
                    </div>
                </div>

                <hr>

                <div class="row mt-3">
                    <div class="col-md-12">
                        <h5><i class="bi bi-geo-alt"></i> Маршрут доставки:</h5>
                        <div class="d-flex align-items-center justify-content-center mt-3">
                            <div class="text-center">
                                <i class="bi bi-geo-fill text-success" style="font-size: 2rem;"></i>
                                <p class="mb-0"><strong>{{ cargo_info['от'] }}</strong></p>
                                <small class="text-muted">Отправление</small>
                            </div>

                            <div class="mx-4">
                                <i class="bi bi-arrow-right" style="font-size: 2rem;"></i>
                            </div>

                            <div class="text-center">
                                <i class="bi bi-geo-alt-fill text-danger" style="font-size: 2rem;"></i>
                                <p class="mb-0"><strong>{{ cargo_info['до'] }}</strong></p>
                                <small class="text-muted">Назначение</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {% elif request.args.get('number') %}
        <div class="alert alert-warning mt-4 shadow">
            <h5><i class="bi bi-exclamation-triangle"></i> Груз не найден</h5>
            <p class="mb-0">
                Груз с номером "<strong>{{ request.args.get('number') }}</strong>" не найден в системе.
                Проверьте правильность номера.
            </p>
        </div>
        {% endif %}

        <!-- Подсказка -->
        <div class="card mt-4">
            <div class="card-body">
                <h6><i class="bi bi-info-circle"></i> Как отследить груз?</h6>
                <ol class="mb-0">
                    <li>Введите номер груза в поле выше</li>
                    <li>Нажмите кнопку "Найти"</li>
                    <li>Просмотрите информацию о статусе и маршруте</li>
                </ol>
            </div>
        </div>
    </div>
</div>
{% endblock %}
