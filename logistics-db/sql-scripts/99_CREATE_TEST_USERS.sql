-- ===================================================================
-- –°–ö–†–ò–ü–¢ –°–û–ó–î–ê–ù–ò–Ø –¢–ï–°–¢–û–í–´–• –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô
-- logistics-db
-- ===================================================================

\c logistics_5nf

-- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é —Ç–∞–±–ª–∏—Ü—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –µ—Å–ª–∏ –µ—Å—Ç—å
DROP TABLE IF EXISTS –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ CASCADE;

-- –°–æ–∑–¥–∞—ë–º —Ç–∞–±–ª–∏—Ü—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CREATE TABLE –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (
    id_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è SERIAL PRIMARY KEY,
    –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è VARCHAR(50) UNIQUE NOT NULL,
    –ø–∞—Ä–æ–ª—å_—Ö–µ—à VARCHAR(255) NOT NULL,
    –ø–æ–ª–Ω–æ–µ_–∏–º—è VARCHAR(150) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    —Ä–æ–ª—å VARCHAR(30) NOT NULL CHECK (—Ä–æ–ª—å IN ('–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', '–º–µ–Ω–µ–¥–∂–µ—Ä', '–ª–æ–≥–∏—Å—Ç', '–≤–æ–¥–∏—Ç–µ–ª—å', '–∫–ª–∏–µ–Ω—Ç')),
    –∞–∫—Ç–∏–≤–µ–Ω BOOLEAN DEFAULT TRUE,
    –¥–∞—Ç–∞_—Å–æ–∑–¥–∞–Ω–∏—è TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    –ø–æ—Å–ª–µ–¥–Ω–∏–π_–≤—Ö–æ–¥ TIMESTAMP
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏_–∏–º—è ON –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏(–∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è);
CREATE INDEX idx_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏_email ON –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏(email);
CREATE INDEX idx_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏_—Ä–æ–ª—å ON –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏(—Ä–æ–ª—å);

-- ===================================================================
-- –í–°–¢–ê–í–ö–ê –¢–ï–°–¢–û–í–´–• –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô
-- –ü–∞—Ä–æ–ª—å –¥–ª—è –≤—Å–µ—Ö: "password123" (—Ö–µ—à bcrypt)
-- ===================================================================

INSERT INTO –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–∞—Ä–æ–ª—å_—Ö–µ—à, –ø–æ–ª–Ω–æ–µ_–∏–º—è, email, —Ä–æ–ª—å) VALUES
-- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
('admin', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5Y5zyp4L8W0eK', '–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á', 'admin@logistics.ru', '–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'),
('superadmin', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5Y5zyp4L8W0eK', '–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤–∏—á', 'superadmin@logistics.ru', '–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'),

-- –ú–µ–Ω–µ–¥–∂–µ—Ä—ã
('manager1', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5Y5zyp4L8W0eK', '–°–∏–¥–æ—Ä–æ–≤–∞ –ê–Ω–Ω–∞ –°–µ—Ä–≥–µ–µ–≤–Ω–∞', 'manager1@logistics.ru', '–º–µ–Ω–µ–¥–∂–µ—Ä'),
('manager2', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5Y5zyp4L8W0eK', '–ö–æ–∑–ª–æ–≤ –î–º–∏—Ç—Ä–∏–π –ê–ª–µ–∫—Å–µ–µ–≤–∏—á', 'manager2@logistics.ru', '–º–µ–Ω–µ–¥–∂–µ—Ä'),

-- –õ–æ–≥–∏—Å—Ç—ã
('logist1', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5Y5zyp4L8W0eK', '–ú–æ—Ä–æ–∑–æ–≤–∞ –ï–ª–µ–Ω–∞ –í–∏–∫—Ç–æ—Ä–æ–≤–Ω–∞', 'logist1@logistics.ru', '–ª–æ–≥–∏—Å—Ç'),
('logist2', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5Y5zyp4L8W0eK', '–ù–∏–∫–æ–ª–∞–µ–≤ –°–µ—Ä–≥–µ–π –ü–∞–≤–ª–æ–≤–∏—á', 'logist2@logistics.ru', '–ª–æ–≥–∏—Å—Ç'),
('logist3', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5Y5zyp4L8W0eK', '–°–æ–∫–æ–ª–æ–≤–∞ –ú–∞—Ä–∏—è –ê–Ω–¥—Ä–µ–µ–≤–Ω–∞', 'logist3@logistics.ru', '–ª–æ–≥–∏—Å—Ç'),

-- –í–æ–¥–∏—Ç–µ–ª–∏
('driver1', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5Y5zyp4L8W0eK', '–í–∞—Å–∏–ª—å–µ–≤ –ê–ª–µ–∫—Å–µ–π –ò–≤–∞–Ω–æ–≤–∏—á', 'driver1@logistics.ru', '–≤–æ–¥–∏—Ç–µ–ª—å'),
('driver2', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5Y5zyp4L8W0eK', '–§–µ–¥–æ—Ä–æ–≤ –ú–∏—Ö–∞–∏–ª –ü–µ—Ç—Ä–æ–≤–∏—á', 'driver2@logistics.ru', '–≤–æ–¥–∏—Ç–µ–ª—å'),

-- –ö–ª–∏–µ–Ω—Ç—ã
('client1', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5Y5zyp4L8W0eK', '–ö–æ–º–ø–∞–Ω–∏—è "–†–æ–≥–∞ –∏ –ö–æ–ø—ã—Ç–∞"', 'client1@company.ru', '–∫–ª–∏–µ–Ω—Ç'),
('client2', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5Y5zyp4L8W0eK', '–û–û–û "–ë—ã—Å—Ç—Ä–∞—è –î–æ—Å—Ç–∞–≤–∫–∞"', 'client2@delivery.ru', '–∫–ª–∏–µ–Ω—Ç'),
('client3', '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5Y5zyp4L8W0eK', '–ò–ü –°–º–∏—Ä–Ω–æ–≤ –ê.–ê.', 'client3@smirnov.ru', '–∫–ª–∏–µ–Ω—Ç');

-- –ü—Ä–æ–≤–µ—Ä–∫–∞
SELECT 
    –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,
    –ø–æ–ª–Ω–æ–µ_–∏–º—è,
    email,
    —Ä–æ–ª—å,
    –∞–∫—Ç–∏–≤–µ–Ω
FROM –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
ORDER BY —Ä–æ–ª—å, –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;

\echo '‚úÖ –°–æ–∑–¥–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:'
SELECT —Ä–æ–ª—å, COUNT(*) as –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ FROM –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ GROUP BY —Ä–æ–ª—å;

\echo ''
\echo 'üìù –õ–æ–≥–∏–Ω: admin / –ü–∞—Ä–æ–ª—å: password123'
\echo 'üìù –õ–æ–≥–∏–Ω: manager1 / –ü–∞—Ä–æ–ª—å: password123'
\echo 'üìù –õ–æ–≥–∏–Ω: logist1 / –ü–∞—Ä–æ–ª—å: password123'
\echo 'üìù –õ–æ–≥–∏–Ω: driver1 / –ü–∞—Ä–æ–ª—å: password123'
\echo 'üìù –õ–æ–≥–∏–Ω: client1 / –ü–∞—Ä–æ–ª—å: password123'
