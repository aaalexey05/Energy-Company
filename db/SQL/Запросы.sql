-- 1Ô∏è‚É£ üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á–µ—Ç (–ü—Ä–∏–±—ã–ª—å vs –†–∞—Å—Ö–æ–¥—ã)
docker exec -it logistics_postgres psql -U logistics_admin -d logistics_5nf -c "
SELECT 
    (SELECT COALESCE(SUM(—Å—É–º–º–∞_—Ä—É–±), 0) FROM –ø–ª–∞—Ç–µ–∂–∏ WHERE —Å—Ç–∞—Ç—É—Å_–ø–ª–∞—Ç–µ–∂–∞ = '–æ–ø–ª–∞—á–µ–Ω') AS –¥–æ—Ö–æ–¥_—Ä—É–±,
    (SELECT COALESCE(SUM(—Å—Ç–æ–∏–º–æ—Å—Ç—å_—Ä—É–±), 0) FROM —Ä–∞—Å—Ö–æ–¥—ã_—Ç–æ–ø–ª–∏–≤–∞) AS —Ä–∞—Å—Ö–æ–¥_—Ç–æ–ø–ª–∏–≤–æ,
    (SELECT COALESCE(SUM(—Å—Ç–æ–∏–º–æ—Å—Ç—å_—Ä—É–±), 0) FROM —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ_–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ) AS —Ä–∞—Å—Ö–æ–¥_—Ä–µ–º–æ–Ω—Ç,
    (
        (SELECT COALESCE(SUM(—Å—É–º–º–∞_—Ä—É–±), 0) FROM –ø–ª–∞—Ç–µ–∂–∏ WHERE —Å—Ç–∞—Ç—É—Å_–ø–ª–∞—Ç–µ–∂–∞ = '–æ–ø–ª–∞—á–µ–Ω') - 
        (SELECT COALESCE(SUM(—Å—Ç–æ–∏–º–æ—Å—Ç—å_—Ä—É–±), 0) FROM —Ä–∞—Å—Ö–æ–¥—ã_—Ç–æ–ø–ª–∏–≤–∞) - 
        (SELECT COALESCE(SUM(—Å—Ç–æ–∏–º–æ—Å—Ç—å_—Ä—É–±), 0) FROM —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ_–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ)
    ) AS —á–∏—Å—Ç–∞—è_–ø—Ä–∏–±—ã–ª—å;
"

-- 2Ô∏è‚É£ üì¶ –°—Ç–∞—Ç—É—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –≥—Ä—É–∑–æ–≤ (–°–≤–æ–¥–∫–∞)
docker exec -it logistics_postgres psql -U logistics_admin -d logistics_5nf -c "
SELECT 
    sz.–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ AS —Å—Ç–∞—Ç—É—Å,
    COUNT(g.–∏–¥_–≥—Ä—É–∑) AS –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ,
    ROUND(COUNT(g.–∏–¥_–≥—Ä—É–∑) * 100.0 / (SELECT COUNT(*) FROM –≥—Ä—É–∑—ã), 1) || '%' AS –ø—Ä–æ—Ü–µ–Ω—Ç
FROM –≥—Ä—É–∑—ã g
JOIN —Å—Ç–∞—Ç—É—Å—ã_–∑–∞–∫–∞–∑–æ–≤ sz ON g.–∏–¥_—Å—Ç–∞—Ç—É—Å = sz.–∏–¥_—Å—Ç–∞—Ç—É—Å
GROUP BY sz.–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
ORDER BY –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ DESC;
"


-- 3
docker exec -it logistics_postgres psql -U logistics_admin -d logistics_5nf -c "
SELECT 
    v.—Ñ–∞–º–∏–ª–∏—è || ' ' || v.–∏–º—è AS –≤–æ–¥–∏—Ç–µ–ª—å,
    t.–≥–æ—Å–Ω–æ–º–µ—Ä,
    COUNT(gis.–∏–¥_–≥—Ä—É–∑) AS –ø–µ—Ä–µ–≤–µ–∑–µ–Ω–æ_–≥—Ä—É–∑–æ–≤
FROM –≤–æ–¥–∏—Ç–µ–ª–∏ v
JOIN —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ_—Å—Ä–µ–¥—Å—Ç–≤–∞ t ON v.–∏–¥_–≤–æ–¥–∏—Ç–µ–ª—å = t.–∏–¥_–≤–æ–¥–∏—Ç–µ–ª—å
JOIN –≥—Ä—É–∑_–∏_—Å—Ä–µ–¥—Å—Ç–≤–∞ gis ON t.–∏–¥_—Å—Ä–µ–¥—Å—Ç–≤–æ = gis.–∏–¥_—Å—Ä–µ–¥—Å—Ç–≤–æ
GROUP BY v.–∏–¥_–≤–æ–¥–∏—Ç–µ–ª—å, t.–≥–æ—Å–Ω–æ–º–µ—Ä
ORDER BY –ø–µ—Ä–µ–≤–µ–∑–µ–Ω–æ_–≥—Ä—É–∑–æ–≤ DESC
LIMIT 5;
"
